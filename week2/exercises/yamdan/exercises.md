## 1. QAPのトレースがなぜ加算ゲートの出力を記録しなくてもいいのか、理由を説明してください。（ヒント: Linear PCP）

QAPやLinear PCPにおいては、加算処理は実際には加算ゲートの段階では行われず、評価が遅延され、その加算ゲート以降に初めて現れる乗算ゲートの入力時にまとめて加算されるとみなすことができる。加算されるべき個々の値は乗算ゲートのセレクタで選択されるため、加算ゲートの出力をわざわざトレースとして持たせる必要はない。

---

## 2. 講義で紹介された算術回路とセレクター多項式をもとにマスター多項式p(x)と商多項式q(x)を一つ考えてください。

講義の例と同様に、有限体 $\mathbb{F}_7$ と要素 $\omega = 2$ を用いた算術回路を考える。
回路への入力には以下のものが与えられたとする。

- $c_1 = 2$
- $c_2 = 3$
- $c_3 = 4$
- $c_4 = 5$
- $c_5 = 6$
- $c_6 = 2$

すると回路の定義から

- $c_7 = c_1 c_2 = 6$
- $c_8 = c_7 (c_3 + c_4) = 6 \cdot 9 = 54 = 5 \pmod{7}$
- $c_9 = (c_3 + c_4)(c_5 + c_6) = 9 \cdot 8 = 72 = 2 \pmod{7}$

と定まる。

#### マスター多項式p(x)

$$
p(x) = x^4 + 6x
$$

左セレクタ多項式は以下のように計算される。

- $l_1(x) = 3x^2+6x+5$
- $l_2(x) = 0$
- $l_3(x) = 5x^2+5x+5$
- $l_4(x) = 5x^2+5x+5$
- $l_5(x) = 0$
- $l_6(x) = 0$
- $l_7(x) = 6x^2+3x+5$
- $l_8(x) = 0$
- $l_9(x) = 0$

よって
$L(x) = \sum c_i l_i(x) = 2(3x^2+6x+5) + 4(5x^2+5x+5) + 5(5x^2+5x+5) + 6(6x^2+3x+5) = 3x^2+5x+1$ .

同様に、右セレクタ多項式は以下のように求められる。

- $r_1(x) = 0$
- $r_2(x) = 3x^2+6x+5$
- $r_3(x) = 6x^2+3x+5$
- $r_4(x) = 6x^2+3x+5$
- $r_5(x) = 5x^2+5x+5$
- $r_6(x) = 5x^2+5x+5$
- $r_7(x) = 0$
- $r_8(x) = 0$
- $r_9(x) = 0$

したがって
$R(x) = \sum c_i r_i(x) = 3(3x^2+6x+5) + 4(6x^2+3x+5) + 5(6x^2+3x+5) + 6(5x^2+5x+5) + 2(5x^2+5x+5) = 5x^2+x+2$ .

また、出力セレクタ多項式も以下のように定まる。

- $o_1(x) = 0$
- $o_2(x) = 0$
- $o_3(x) = 0$
- $o_4(x) = 0$
- $o_5(x) = 0$
- $o_6(x) = 0$
- $o_7(x) = 3x^2+6x+5$
- $o_8(x) = 6x^2+3x+5$
- $o_9(x) = 5x^2+5x+5$

よって
$O(x) = \sum c_i o_i(x) = 6(3x^2+6x+5) + 5(6x^2+3x+5) + 2(5x^2+5x+5) = 2x^2+5x+2$ .

したがってマスター多項式は
$p(x) = L(x) R(x) - O(x) = x^4 + 6x$
と計算される。

#### 商多項式q(x)

$$
q(x) = x
$$

消失多項式は
$V(x) = (x-\omega)(x-\omega^2)(x-\omega^3) = (x-2)(x-4)(x-1) = x^3 + 6$
であるから、
$q(x) = p(x) / V(x) = x$ .

---

## 3. Linear PCPベースのSNARKとGroth16がどのような安全性仮定に基づいているか説明してください。(ヒント: Generic Group Model, KoE Assumption)

Linear PCPベースのSNARKであるPinocchioの健全性は **KoE (Knowledge of Exponent) Assumption** に基づいて示される。

Groth16の健全性は **Generic Group Model** に基づいて示される。

KoE Assumptionを採用する場合、パラメータの個数を約2倍に増やす必要がある。
一方、Generic Group Modelを採用する場合はパラメータの追加は不要。

ただしGeneric Group Modelの下で示された安全性は、実際の群ではなく理想化された群(Generic Group)を前提にしたものなので、現実の群が持つ固有の性質で安全性が破られる可能性を残す、限定的なものでしかない。(が、よく使われているように見える)

KoE Assumptionも少し特殊な仮定で、
$g$ と $g^\alpha$ を与えられた攻撃者が
$h$ と $h^\alpha$ を出力できたなら、
攻撃者は必ず $h = g^x$ となる $x$ を知っていて、
$h^\alpha \gets (g^\alpha)^x$ として $h^\alpha$ を生成したに違いない。
なので攻撃者から $x$ を抽出できる Extractor が構成できる！
というもの。(このためにわざわざ $g^\alpha$ 達を導入してパラメータサイズが倍増する)
離散対数仮定やDH仮定のような標準的な仮定とは毛色が違うので敬遠されることもある(らしい)が、Generic Group Modelに比べるとより現実的と言える(らしい)。

---